<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SIUT BSN Mock Test</title>

<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: #f4f4f4;
}
.hidden { display: none; }

#timer {
    position: fixed;
    top: 0;
    width: 100%;
    background: #222;
    color: #00ff6a;
    text-align: center;
    padding: 15px;
    font-size: 22px;
    font-weight: bold;
}

.container {
    max-width: 900px;
    margin: 90px auto 30px;
    background: #fff;
    padding: 20px;
    border-radius: 6px;
}

h1, h2 {
    text-align: center;
    color: #0056b3;
}

.question {
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid #ddd;
}

.options label {
    display: block;
    margin: 6px 0;
    cursor: pointer;
}

button {
    width: 100%;
    padding: 14px;
    font-size: 18px;
    background: #d9534f;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

input[type=text] {
    width: 100%;
    padding: 12px;
    font-size: 16px;
}

.expired {
    text-align: center;
    color: red;
    font-size: 22px;
    margin-top: 15px;
}
</style>
</head>

<body>

<!-- TIMER -->
<div id="timer" class="hidden">
Time Remaining: <span id="time">100:00</span>
</div>

<!-- LOGIN -->
<div class="container" id="loginBox">
<h1>SIUT BSN Entrance Mock Test</h1>
<p>Enter Student Name to Start Test</p>
<input type="text" id="studentName" placeholder="Enter your name">
<br><br>
<button onclick="startTest()">Start Test</button>
<p id="expiryMsg" class="expired hidden">‚ùå This test has expired.</p>
</div>

<!-- TEST -->
<div class="container hidden" id="testBox">
<h2 id="welcome"></h2>
<div id="questions"></div>
<button onclick="finishTest()">Finish Exam</button>
</div>

<!-- RESULT -->
<div class="container hidden" id="resultBox">
<h1>Result</h1>
<h2 id="resultName"></h2>
<p id="scoreText"></p>
</div>

<script>
/* ================= 2-HOUR EXPIRY (FROM FIRST OPEN) ================= */

const TEST_DURATION = 2 * 60 * 60 * 1000; // 2 hours

function isTestExpired() {
    let startTime = localStorage.getItem("testStartTime");

    if (!startTime) {
        localStorage.setItem("testStartTime", Date.now());
        return false;
    }
    return Date.now() > (parseInt(startTime) + TEST_DURATION);
}

/* ================= QUESTIONS (AUTO 100) ================= */

const subjects = ["Biology","Chemistry","Physics","English","GK"];
const baseQuestions = [
  { q: "The powerhouse of the cell is?", o: ["Nucleus","Mitochondria","Ribosome","Golgi body"], a: 1 },
  { q: "Insulin is secreted by?", o: ["Liver","Pancreas","Kidney","Heart"], a: 1 },
  { q: "Capital of Pakistan is?", o: ["Karachi","Lahore","Islamabad","Peshawar"], a: 2 },
  { q: "Unit of force is?", o: ["Watt","Newton","Joule","Pascal"], a: 1 },
  { q: "Synonym of 'Rapid' is?", o: ["Slow","Fast","Late","Weak"], a: 1 }
];

const questions = [];
for (let i = 0; i < 100; i++) {
    const b = baseQuestions[i % baseQuestions.length];
    questions.push({
        q: `(${subjects[i % 5]}) Question ${i + 1}: ${b.q}`,
        options: b.o,
        answer: b.a
    });
}

/* ================= TIMER ================= */

let time = 100 * 60;
let timerInterval;

function startTimer() {
    document.getElementById("timer").classList.remove("hidden");
    timerInterval = setInterval(() => {
        if (time > 0) {
            time--;
            let m = Math.floor(time / 60);
            let s = time % 60;
            document.getElementById("time").innerText =
                (m < 10 ? "0" : "") + m + ":" + (s < 10 ? "0" : "") + s;
        } else {
            finishTest();
        }
    }, 1000);
}

/* ================= START TEST ================= */

function startTest() {
    if (isTestExpired()) {
        document.getElementById("expiryMsg").classList.remove("hidden");
        return;
    }

    const name = document.getElementById("studentName").value.trim();
    if (!name) {
        alert("Please enter student name");
        return;
    }

    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("testBox").classList.remove("hidden");
    document.getElementById("welcome").innerText = "Student: " + name;

    renderQuestions();
    startTimer();
}

/* ================= RENDER QUESTIONS ================= */

function renderQuestions() {
    const qBox = document.getElementById("questions");
    qBox.innerHTML = "";

    questions.forEach((q, i) => {
        const div = document.createElement("div");
        div.className = "question";
        div.innerHTML = `<b>${i + 1}. ${q.q}</b>`;

        q.options.forEach((opt, j) => {
            div.innerHTML += `
            <label>
                <input type="radio" name="q${i}" value="${j}"> ${opt}
            </label>`;
        });

        qBox.appendChild(div);
    });
}

/* ================= FINISH & SCORE ================= */

function finishTest() {
    clearInterval(timerInterval);

    let score = 0;
    questions.forEach((q, i) => {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        if (selected && parseInt(selected.value) === q.answer) {
            score++;
        }
    });

    document.getElementById("testBox").classList.add("hidden");
    document.getElementById("timer").classList.add("hidden");
    document.getElementById("resultBox").classList.remove("hidden");

    document.getElementById("resultName").innerText =
        "Student: " + document.getElementById("studentName").value;

    document.getElementById("scoreText").innerText =
        `Score: ${score} / 100`;
}
</script>

</body>
</html>
